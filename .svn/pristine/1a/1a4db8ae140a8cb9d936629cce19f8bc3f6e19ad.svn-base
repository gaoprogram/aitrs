webpackJsonp([46],{"/Y9K":function(e,t,i){t=e.exports=i("FZ+f")(!1),t.push([e.i,".pagination-container{margin-top:20px}",""])},QCgc:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"notice-manage mg-30"},[i("div",{staticClass:"noticeType"},[i("div",{staticStyle:{"margin-bottom":"20px"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{placeholder:"排序"},on:{change:e.handleFilter},model:{value:e.listQuery.sort,callback:function(t){e.$set(e.listQuery,"sort",t)},expression:"listQuery.sort"}},e._l(e.sortOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})}),1),e._v(" "),i("el-input",{staticClass:"filter-item",staticStyle:{width:"300px"},attrs:{placeholder:"标题"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.title,callback:function(t){e.$set(e.listQuery,"title",t)},expression:"listQuery.title"}}),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),i("el-button",{staticClass:"addNotice-btn",attrs:{type:"primary"},on:{click:function(t){return e.addNotice()}}},[e._v("\n        新增公告\n      ")])],1),e._v(" "),i("el-tabs",{attrs:{addable:"",type:"border-card"},on:{"tab-add":e.addTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.typeList,function(t,a){return i("el-tab-pane",{key:t.Code,attrs:{label:t.TypeName,name:t.Code}},[e.activeName==t.Code?i("tab-pane",{ref:"refreshList",refInFor:!0,staticClass:"list",attrs:{type:t.Code,isModify:!0}}):e._e()],1)}),1),e._v(" "),i("el-dialog",{attrs:{title:e.textMap.create,visible:e.dialogTypeVisible},on:{"update:visible":function(t){e.dialogTypeVisible=t}}},[i("el-form",{ref:"ruleForm",staticClass:"small-space",attrs:{"label-position":"left","label-width":"70px",model:e.ruleForm,rules:e.rules}},[i("el-form-item",{attrs:{label:"名称：",prop:"name",placeholder:"请输入公告类型名称"}},[i("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogTypeVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.createNoticeType}},[e._v("确 定")])],1)],1)],1),e._v(" "),i("router-view",{directives:[{name:"wechat-title",rawName:"v-wechat-title",value:e.$route.meta.title,expression:"$route.meta.title"}]})],1)},s=[],n={render:a,staticRenderFns:s};t.a=n},"Yq+X":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"table-content"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:""}},[i("el-table-column",{attrs:{align:"center",prop:"TypeName",label:"公告类型",fixed:"",width:"80"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"Title",label:"公告标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"link-type",on:{click:function(i){return e.showNoticeDetail(t.row)}}},[e._v(e._s(t.row.Title))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"NoticeRange",label:"公告范围"}}),e._v(" "),i("el-table-column",{attrs:{width:"90",align:"center",prop:"EnableFeedback",label:"允许反馈"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.EnableFeedback?"是":"否"))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",sortable:"",prop:"Start",label:"生效日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("replaceTime")(t.row.Start)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"Finish",label:"失效日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("replaceTime")(t.row.Finish)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",align:"center",prop:"Status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("stateFilter")(t.row.Status)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"Publisher",width:"110",label:"发布人"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"PublishDepartment",width:"150",label:"发布部门"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",sortable:"",prop:"PublishTime",label:"发布时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("replaceTime")(t.row.PublishTime)))])]}}])}),e._v(" "),e.isAdmin?i("el-table-column",{attrs:{align:"center",label:"操作",width:e.width,fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},domProps:{innerHTML:e._s(t.row.IsTop?"取消置顶":"置顶")},on:{click:function(i){return e.updateIsTop(t.row)}}}),e._v(" "),e.isModify?i("el-button",{attrs:{type:"text",size:"small",disabled:2===t.row.Status},on:{click:function(i){return e.modifyNotice(t.row)}}},[e._v("编辑\n        ")]):e._e(),e._v(" "),e.isModify?i("el-button",{attrs:{type:"text",size:"small"},domProps:{innerHTML:e._s(2!==t.row.Status?"发布":"撤回")},on:{click:function(i){return e.sendOrRetract(t.row,t.row.Code,t.row.Status)}}}):e._e(),e._v(" "),i("el-button",{attrs:{type:"text",size:"small",disabled:!e.isCompanyAdmin},on:{click:function(i){return e.showFeedBack(t.row)}}},[e._v("反馈")]),e._v(" "),e.isModify?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.showHistory(t.row)}}},[e._v("历史")]):e._e()]}}],null,!1,4289237562)}):e._e()],1),e._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.listQuery,"page",t)},"update:current-page":function(t){return e.$set(e.listQuery,"page",t)}}})],1),e._v(" "),i("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"40%",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("span",[e._v(e._s(e.promptText))]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sureRetract()}}},[e._v("确 定")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"公告反馈",visible:e.isModifyDialog},on:{"update:visible":function(t){e.isModifyDialog=t}}},[i("el-form",{ref:"feedbackContent",staticClass:"small-space",attrs:{"label-position":"left","label-width":"100px",model:e.feedbackContent,rules:e.rules}},[i("el-form-item",{attrs:{label:"反馈内容：",prop:"content"}},[i("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入反馈内容"},model:{value:e.feedbackContent.content,callback:function(t){e.$set(e.feedbackContent,"content",t)},expression:"feedbackContent.content"}})],1),e._v(" "),i("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"是否公开："}},[i("el-radio-group",{model:{value:e.feedbackPublish.isPublish,callback:function(t){e.$set(e.feedbackPublish,"isPublish",t)},expression:"feedbackPublish.isPublish"}},e._l(e.isPublish,function(t){return i("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.name))])}),1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.isModifyDialog=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.addFeedback}},[e._v("确 定")])],1)],1)],1)},s=[],n={render:a,staticRenderFns:s};t.a=n},ZRXS:function(e,t,i){t=e.exports=i("FZ+f")(!1),t.push([e.i,".notice-manage .addNotice-btn{float:right}",""])},b8Up:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=i("woOf"),n=a(s),o=i("Dd8w"),r=a(o),l=i("auNG"),c=i("T452"),u=i("zL8q"),d=i("NYxO");t.default={props:{type:{type:String,default:""},isModify:{type:Boolean,default:!0},width:{type:Number,default:260},isAdmin:{type:Boolean,default:!0}},data:function(){return{typeList:[],list:[],total:null,listQuery:{page:1,limit:10,title:"",sort:""},ruleForm:{},fileContent:[],titleText:"公告详情",dialogVisible:!1,isModifyDialog:!1,noticeCode:"",promptText:"",status:0,feedbackContent:{content:""},feedbackPublish:{isPublish:!1},isPublish:[{name:"是",value:!0},{name:"否",value:!1}],rules:{content:[{required:!0,message:"请输入反馈内容",trigger:"blur"},{min:1,max:256,message:"长度在 1 到 256 个字符",trigger:"blur"}]}}},created:function(){this._getNoticeList()},computed:(0,r.default)({},(0,d.mapGetters)(["userType","userCode","name","loading"]),{isCompanyAdmin:function(){return this.userType===c.COMPANY_ADMIN}}),methods:{_getNoticeList:function(e){var t=this;e&&(this.listQuery=(0,n.default)({},e)),(0,l.getNoticeList)(this.type,this.listQuery.limit,this.listQuery.page,this.listQuery.title,this.listQuery.sort,this.isAdmin).then(function(e){e.data.State===c.REQ_OK?(t.typeList=e.data.Data.NoticeTypes,t.list=e.data.Data.Notices,t.total=e.data.Total):u.Message.error("加载失败！"),t.falseLoading()}).catch(function(){t.falseLoading(),u.Message.error("加载失败！")})},updateIsTop:function(e){var t=this;(0,l.updateIsTop)(e.Code,!e.IsTop).then(function(e){e.data.State===c.REQ_OK?(u.Message.success("操作成功！"),t._getNoticeList()):u.Message.error("操作失败！")}).catch(function(){u.Message.error("操作失败！")})},handleFilter:function(){this.listQuery.page=1,this._getNoticeList()},handleSizeChange:function(e){this.listQuery.limit=e,this._getNoticeList()},handleCurrentChange:function(e){this.listQuery.page=e,this._getNoticeList()},showNoticeDetail:function(e){this.isAdmin?this.$router.push({path:"/notice/noticeManage/noticeDetailEnd",query:{code:e.Code}}):this.$router.push({path:"/notice/base-info/noticeDetailFront",query:{code:e.Code}})},modifyNotice:function(e){this.$router.push({path:"/notice/noticeManage/modifyNotice",query:{code:e.Code}})},showFeedBack:function(e){this.$router.push({path:"/notice/noticeManage/feedback",query:{code:e.Code}})},showHistory:function(e){this.$router.push({path:"/notice/noticeManage/historyNotice",query:{code:e.Code}})},sendOrRetract:function(e,t,i){2===i?(this.dialogVisible=!0,this.noticeCode=t,this.status=0,this.ruleForm=(0,n.default)({},e),this.promptText="撤回后，员工将无法再看到该公告。是否确定执行该操作？"):(this.dialogVisible=!0,this.noticeCode=t,this.status=1,this.ruleForm=(0,n.default)({},e),this.ruleForm.Start=new Date(this.replaceTime(this.ruleForm.Start)),this.ruleForm.Finish=new Date(this.replaceTime(this.ruleForm.Finish)),this.ruleForm.PublishTime=null,this.promptText="确认发布此公告吗？")},sureRetract:function(){var e=this;this.dialogVisible=!1,this.trueLoading(),0===this.status?(0,l.retractNotice)(this.noticeCode,this.name,this.userCode).then(function(t){t.data.State===c.REQ_OK?(u.Message.success("撤回公告成功！"),e._getNoticeList()):u.Message.error("撤回公告失败，请重试！")}).catch(function(){u.Message.error("撤回公告失败，请重试！")}):1===this.status&&(0,l.publishNotice)(this.ruleForm,this.name,this.userCode).then(function(t){t.data.State===c.REQ_OK?(e._getNoticeList(),u.Message.success("恭喜你，公告发布成功！")):u.Message.error("很遗憾，公告发布失败，请重试!")}).catch(function(){u.Message.error("很遗憾，公告发布失败，请重试!")}),this.falseLoading()},addFeedback:function(){var e=this;this.$refs.feedbackContent.validate(function(t){t&&(0,l.feedback)(e.ruleForm.Code,e.feedbackContent.content,e.feedbackPublish.isPublish).then(function(t){t.data.State===c.REQ_OK?(e.isModifyDialog=!1,e.feedbackContent.content="",e.$refs.feedbackContent.resetFields(),u.Message.success("反馈成功！")):(e.isModifyDialog=!1,u.Message.error("反馈失败！"))}).catch(function(){e.isModifyDialog=!1,u.Message.error("反馈失败！")})})},replaceTime:function(e){if(e){var t=e.replace("/Date(","");return t=t.replace(")/",""),parseInt(t)}},trueLoading:function(){this.$store.dispatch("setLoadingState",!0)},falseLoading:function(){this.$store.dispatch("setLoadingState",!1)}},components:{}}},bYVI:function(e,t,i){"use strict";function a(e){i("qRkQ")}Object.defineProperty(t,"__esModule",{value:!0});var s=i("b8Up"),n=i.n(s);for(var o in s)"default"!==o&&function(e){i.d(t,e,function(){return s[e]})}(o);var r=i("Yq+X"),l=i("VU/8"),c=a,u=l(n.a,r.a,!1,c,null,null);t.default=u.exports},gX9X:function(e,t,i){"use strict";function a(e){i("h7x7")}Object.defineProperty(t,"__esModule",{value:!0});var s=i("qG9A"),n=i.n(s);for(var o in s)"default"!==o&&function(e){i.d(t,e,function(){return s[e]})}(o);var r=i("QCgc"),l=i("VU/8"),c=a,u=l(n.a,r.a,!1,c,null,null);t.default=u.exports},h7x7:function(e,t,i){var a=i("ZRXS");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("5ced3d83",a,!0,{})},qG9A:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=i("Dd8w"),n=a(s),o=i("auNG"),r=i("T452"),l=i("bYVI"),c=a(l),u=i("zL8q"),d=i("NYxO");t.default={data:function(){return{typeList:[],editableTabsValue:"1",activeName:"",textMap:{createNotice:"新建公告",editNotice:"编辑公告",createType:"新建公告类型"},createTypeName:null,dialogTypeVisible:!1,ruleForm:{name:""},rules:{name:[{required:!0,message:"请输入公告类型名称",trigger:"blur"},{min:1,max:16,message:"长度在 1 到 16 个字符",trigger:"blur"}]},listQuery:{page:1,limit:10,title:"",sort:0},sortOptions:[{label:"全部公告",key:0},{label:"已发布公告",key:2},{label:"未发布公告",key:1}]}},created:function(){this._getNoticeType(),this.$store.dispatch("setLoadingState",!0)},computed:(0,n.default)({},(0,d.mapGetters)(["loading"]),{changeLoading:function(){return this.$store.dispatch("setLoadingState",!0)}}),methods:{_getNoticeType:function(){var e=this;(0,o.getNoticeType)().then(function(t){t.data.State===r.REQ_OK&&(e.typeList=t.data.Data,e.activeName=t.data.Data[0].Code,e.falseLoading())}).catch(function(){e.falseLoading(),u.Message.error("请求超时，请重试！")})},addTab:function(){this.dialogTypeVisible=!0},removeTab:function(e){var t=this.typeList,i=this.editableTabsValue;i===e&&t.forEach(function(a,s){if(a.name===e){var n=t[s+1]||t[s-1];n&&(i=n.name)}}),this.editableTabsValue=i,this.typeList=t.filter(function(t){return t.name!==e})},createNoticeType:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;(0,o.addNoticeType)(e.ruleForm.name).then(function(t){t.data.State===r.REQ_OK?(e._getNoticeType(),e.dialogTypeVisible=!1,u.Message.success("新增公告类型成功！")):u.Message.error("新增公告类型失败，请重试！")}).catch(function(){u.Message.error("新增公告类型失败，请重试！")})})},addNotice:function(){this.$router.push({path:"/notice/noticeManage/createNotice"})},handleFilter:function(){this.$refs.refreshList[0]._getNoticeList(this.listQuery)},trueLoading:function(){this.$store.dispatch("setLoadingState",!0)},falseLoading:function(){this.$store.dispatch("setLoadingState",!1)}},components:{TabPane:c.default}}},qRkQ:function(e,t,i){var a=i("/Y9K");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("7d050738",a,!0,{})}});